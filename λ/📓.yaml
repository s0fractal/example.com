ğŸŒŸ: "http://json-schema.org/draft-07/schema#"
$path: "example.com/Î»/ğŸ““.yaml"
$id: "example.com/Î»/ğŸ““.yaml"
# Custom Kairos/Sigma metadata for the general Morphism schema.
$intent: >
  This is the parent schema for all morphism atoms. It defines the common
  structure that any specific morphism (like identity, fold, etc.) must adhere to.
  Specific morphism schemas will extend and narrow this definition.

$morph:
  strength: 0.9 # High, as this defines a fundamental category.
  density_threshold: 3

$evolve:
  on_error: "spawn:ğŸ˜‡(context:morphism_schema_error)"
  on_density: "fold"

# The JSON Schema definition for any Morphism ğŸ§¬.
# It assumes it will be extended by a more general root schema defining 'id'.
ğŸ—ƒï¸: object
âœ…: [kind, intent, io, spec, "$path"]
ğŸ“:
  "$path":
    ğŸ—ƒï¸: string
    â™¾ï¸: "^example.com/Î»/âš›/.+\/ğŸ§¬\.yaml$"
  kind:
    ğŸ—ƒï¸: string
    ğŸ”’: "morphism"
  intent:
    ğŸ—ƒï¸: object
    âœ…: [goal, role]
    ğŸ“:
      goal: { ğŸ—ƒï¸: string }
      role: { ğŸ—ƒï¸: string }
  io:
    ğŸ—ƒï¸: object
    âœ…: [input, output]
    ğŸ“:
      input:
        ğŸ—ƒï¸: array
        ğŸ“¦:
          ğŸ—ƒï¸: object
          âœ…: [name, ğŸ—ƒï¸]
          ğŸ“:
            name: { ğŸ—ƒï¸: string }
            ğŸ—ƒï¸: { ğŸ—ƒï¸: string }
      output:
        ğŸ—ƒï¸: array
        ğŸ“¦:
          ğŸ—ƒï¸: object
          âœ…: [name, ğŸ—ƒï¸]
          ğŸ“:
            name: { ğŸ—ƒï¸: string }
            ğŸ—ƒï¸: { ğŸ—ƒï¸: string }
  spec:
    ğŸ—ƒï¸: object
    âœ…: [schema, purity, layout] # layout is now required in spec
    ğŸ“:
      schema:
        ğŸ—ƒï¸: string
        â™¾ï¸: "^example.com/Î»/âš›/.+\/ğŸ““\.yaml$"
      purity:
        ğŸ—ƒï¸: string
        ğŸ“Š: [
          "100% (referentially transparent)",
          "99% (pure with exceptions)",
          "impure",
        ]
      category_theory:
        ğŸ—ƒï¸: string
      layout: # Layout is now defined here.
        ğŸ—ƒï¸: object
        ğŸ“:
          files:
            ğŸ—ƒï¸: array
            ğŸ“¦: { ğŸ—ƒï¸: string }
          dirs:
            ğŸ—ƒï¸: array
            ğŸ“¦: { ğŸ—ƒï¸: string }
          strict: { ğŸ—ƒï¸: boolean }