# Standard JSON Schema declaration.
$schema: "https://json-schema.org/draft/2020-12/schema"

# Custom Kairos/Sigma metadata for the general Angel schema.
$intent: >
  This is the parent schema for all Angel atoms. Angels are autonomous agents
  that perform tasks and enforce rules within the system.

$morph:
  strength: 0.95
  density_threshold: 5

$evolve:
  on_error: "spawn:angel(context:angel_schema_error)"
  on_density: "fold"

# The JSON Schema definition for any Angel Seed.
type: object
required: [kind, intent, spec, runtime]
properties:
  kind:
    type: string
    const: "agent" # Angels are a type of agent
  intent:
    type: object
    required: [goal, role, conditions]
    properties:
      goal: { type: string }
      role: { type: string }
      conditions: { type: array, items: { type: string } }
  spec:
    type: object
    required: [schema]
    properties:
      schema:
        type: string
        pattern: "^example.com/ðŸ§ /ðŸ˜‡/.+\/schema\.yaml$"
  runtime:
    type: object
    required: [entrypoint, task_name]
    properties:
      # The main logic file for the angel's reflex.
      entrypoint:
        type: string
        pattern: "^example.com/ðŸ§ /ðŸ˜‡/.+\/reflex\.ts$"
      # The name of the task in deno.json
      task_name:
        type: string
